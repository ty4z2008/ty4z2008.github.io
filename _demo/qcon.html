<!DOCTYPE HTML>
<html>

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="//cdn.staticfile.org/zui/1.4.0/css/zui.min.css">
    <title>Qcon keynote</title>
    <style type="text/css">
        .input-large {
            height: 43px;
            padding: 10px 16px;
            font-size: 17px;
            line-height: 1.25;
            border-radius: 6px;
            width: 70%;
            border: 1px solid #8E8E8E;
        }
    </style>
</head>


<body>
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-lg-12" style="text-align:center">
                <h4>点击<a href="http://ppt.geekbang.org/" target="_blank" alt="QCon北京2016幻灯片下载合集">QCon北京2016幻灯片下载合集</a>，选择你想看的ppt。
                  先打开，然后复制第一张图片地址到下面的输入框。点击确认即可。（支持方向键“→”与“←”翻页）
                  <a href="http://7xtcs7.com2.z0.glb.clouddn.com/two.gif" target="_blank" alt="演示视频">演示视频</a></h4>
            </div>
            <div class="col-md-12 col-lg-12" id="img" style="height:600px;text-align:center">

            </div>
            <div style="position:relative;text-align:center;margin-top:20px;">
                <input type="text" id="domain" class="input-large" placeholder="http://7xiox7.com2.z0.glb.qiniucdn.com/571b28399dd0f-01.jpg?2016">
                <button class="btn btn-success" id="confirm">确认</button>
                <br/>
                <br/>
                <button class="btn btn-info" id="up" data-page="1">上一页</button>

                <button class="btn btn-success" id="next" data-page="1">下一页</button>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="http://cdn.bootcss.com/jquery/1.12.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            var qiniu_modal = 'imageView2/2/w/800/h/800/format/jpg/interlace/1/q/80/ignore-error/1';
            var _e = (function() {
                var qix = {};
                qix.next = function(e) {
                    var _domain_10 = ($("#domain").val()).substring(0, $("#domain").val().search(/-\d{2}.*/g));
                    var tmp = $("#next").attr("data-page");
                    tmp = parseInt(tmp) + parseInt(1);
                    if (tmp < 10) {
                        var str = '<img src="' + _domain_10 + '-0' + tmp + '.jpg?' + qiniu_modal + '">'
                    } else {
                        var str = '<img src="' + _domain_10 + '-' + tmp + '.jpg?' + qiniu_modal + '">'
                    }


                    $("#img").html(str);
                    $("img").on("error", function() {
                        if (tmp < 10) {
                            var str = '<img src="' + _domain_10 + '-0' + tmp + '.jpg?' + qiniu_modal + '">'
                        } else {
                            var str = '<img src="' + _domain_10 + '-' + tmp + '.jpg?' + qiniu_modal + '">'
                        }
                        $("#img").html(str);
                        alert("已经最后一页了");
                        return false;
                    })
                    $("#next").attr("data-page", tmp);
                    $("#up").attr("data-page", tmp)
                }
                qix.up = function(e) {
                    var _domain_10 = ($("#domain").val()).substring(0, $("#domain").val().search(/-\d{2}.*/g));
                    var tmp = $("#up").attr("data-page");
                    tmp = parseInt(tmp) - parseInt(1);

                    if (tmp < 10 && tmp > 0) {
                        var str = '<img src="' + _domain_10 + '-0' + tmp + '.jpg?' + qiniu_modal + '">'
                    } else if (tmp == 0) {
                        alert("第一页了")
                    } else {
                        var str = '<img src="' + _domain_10 + '-' + tmp + '.jpg?' + qiniu_modal + '">'
                    }
                    $("#img").html(str)
                    $("#up").attr("data-page", tmp);
                    $("#next").attr("data-page", tmp);
                }
                return {
                    up: qix.up,
                    next: qix.next
                }
            })()
            $("#confirm").click(function() {
                var _domain_10 = ($("#domain").val()).substring(0, $("#domain").val().search(/-\d{2}.*/g));
                $("#up").attr("data-page", 1);
                $("#next").attr("data-page", 1);
                $("#img").html('<img src="' + _domain_10 + '-01.jpg?' + qiniu_modal + '">');
            });

            $("#up").click(function(e) {
                _e.up(e)
            });
            $("#next").click(function(e) {
                _e.next(e)
            })
            document.onkeyup = function(e) {
                var code = e.keyCode || e.which;

                if (code == 37 || code == 38) {
                    var elm = $("up")
                    _e.up(elm)
                    e.preventDefault()
                    e.stopPropagation()
                    return false
                }
                if (code == 39 || code == 40) {
                    var elm = $("next")
                    _e.next(elm)
                    e.preventDefault();
                    e.stopPropagation()
                    return false
                }
                return false
            }
        })
    </script>

</body>
