<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" /> <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]--> <title>关于PostgreSQL的时间和货币区域问题</title> <meta name="description" content="出现情况的背景:购买的是Linode的服务,服务的所在地在日本,而地理区域却是美国,但是部署的应用是针对国内区域,在开始安装pg的时候没有太上心,但随着业务的发展和应用的更新区域的问题就慢慢的出现了.例如用户注册的时间,收费项目计费的计算时间,货币单位(Monetary types)等等就开始影响业务的发展.那么..."> <!--<link href='http://fonts.useso.com/css?family=Open+Sans:400,400italic,600|Droid+Sans+Mono' rel='stylesheet' type='text/css'>--> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://blog.microdba.com/database/pg/2015/07/05/first-blog.html"> <link rel="alternate" type="application/rss+xml" title="草稿本" href="http://blog.microdba.com/feed.xml" /> <script src="/assets/js/prefixfree.js"></script> </head> <body> <aside id="sidebar"> <div id="sidebar-left"> <a id="sidebar-avatar" href="/"> <img id="sidebar-avatar-img" alt="" src="/assets/img/avatar.jpg"/> </a> <div id="sidebar-social"> <a href="/feed.xml" class="sidebar-social-icon feed"></a> <a href="mailto:ty4z2008@gmail.com" class="sidebar-social-icon email"></a> <a href="http://www.weibo.com/ty4z2008" class="sidebar-social-icon weibo" target="_blank"></a> <a href="https://github.com/ty4z2008" class="sidebar-social-icon github" target="_blank"></a> </div> <ul id="sidebar-tags"> <li class="sidebar-tag active" data-filter="all">全部文章</li> <li class="sidebar-tag" data-filter="PostgreSQL">PostgreSQL</li> <li class="sidebar-tag" data-filter="数据库系统">数据库系统</li> <li class="sidebar-tag" data-filter="DevTools">DevTools</li> </ul> </div> <div id="sidebar-right"> <div id="search-box"> <input id="search-input" type="text" placeholder="搜索文章" /> </div> <nav id="toc"> <a class="toc-link" data-tags="DevTools" href="/dev/tools/2015/07/05/atom-plugins.html"> Atom常用插件 </a> <a class="toc-link" data-tags="PostgreSQL 数据库系统" href="/database/pg/2015/07/05/first-blog.html"> 关于PostgreSQL的时间和货币区域问题 </a> </nav> </div> </aside> <main id="main"> <article class="post container"> <div class="post-meta"> <span class="post-meta-span date">2015 July 05</span> <span class="post-meta-span tag">PostgreSQL, 数据库系统</span> </div> <h1 class="post-title">关于PostgreSQL的时间和货币区域问题</h1> <p>出现情况的背景:购买的是<a href="https://www.linode.com/">Linode</a>的服务,服务的所在地在日本,而地理区域却是美国,但是部署的应用是针对国内区域,在开始安装pg的时候没有太上心,但随着业务的发展和应用的更新区域的问题就慢慢的出现了.例如用户注册的时间,收费项目计费的计算时间,货币单位(Monetary types)等等就开始影响业务的发展.那么能够做的就是对数据库系统和OS系统的位置区域进行调整.</p> <p>环境:CentOS 7 数据库:PostgreSQL 9.3.6</p> <p>解决方案:</p> <p>1.修改CentOS的系统时区:<code class="highlighter-rouge">tzselect</code>命令选择Asia按照提示操作即可,另外一种方法是直接拷贝文件</p> <p><code class="highlighter-rouge">sudo cp /usr/share/zoneinfo/$主时区/$次时区 /etc/localtime</code></p> <p>在中国可以使用(以上海为例)：</p> <p><code class="highlighter-rouge">sudo cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></p> <p>2.修改postgresql.conf:</p> <div class="highlighter-rouge"><pre class="highlight"><code>lc_messages <span class="o">=</span> <span class="s1">'zh_CN.UTF-8'</span>			<span class="c"># 系统错误信息用中文显示</span>

lc_monetary <span class="o">=</span> <span class="s1">'zh_CN.utf8'</span>			<span class="c"># 货币格式选择人民币</span>

lc_numeric <span class="o">=</span> <span class="s1">'zh_CN.UTF-8'</span>			<span class="c"># 数据类型</span>

lc_time <span class="o">=</span> <span class="s1">'zh_CN.UTF-8'</span>				<span class="c"># 时区</span>
</code></pre></div> <p>保存之后重新载入配置文件即可: <code class="highlighter-rouge">shell select pg_reload_conf(); </code> or</p> <div class="highlighter-rouge"><pre class="highlight"><code>pg_ctl -D data_dir  reload
</code></pre></div> <p>参考资料：</p> <p>1.<a href="https://wiki.postgresql.org/wiki/9.1%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%8C%E7%AB%A0">第二十二章 区域</a></p> <p>2.<a href="http://www.postgresql.org/docs/current/static/datatype-money.html">Monetary Types</a></p> <p>3.<a href="http://www.postgresql.org/docs/current/static/app-pg-ctl.html">pg_ctl</a></p> </article> <div class="post-share"> <div class="container"> <a href="https://twitter.com/share?url=http://blog.microdba.com/database/pg/2015/07/05/first-blog.html&text=关于PostgreSQL的时间和货币区域问题" target="_blank" class="post-share-icon twitter"></a> <a href="https://www.evernote.com/clip.action?url=http://blog.microdba.com/database/pg/2015/07/05/first-blog.html&title=关于PostgreSQL的时间和货币区域问题" target="_blank" class="post-share-icon evernote"></a> <a href="http://service.weibo.com/share/share.php?url=http://blog.microdba.com/database/pg/2015/07/05/first-blog.html&title=关于PostgreSQL的时间和货币区域问题" target="_blank" class="post-share-icon weibo"></a> </div> </div> <div class="comment container"> <div id="disqus_thread"> <a href=""></a> </div> </div> <div class="footer"> <div class="container"> <p class="footer-entry">版权所有&copy;转载请注明出处.</p> <p class="footer-entry">Buit with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll theme</a> • Hosted on <a href="https://pages.github.com/" target="_blank">Github</a></p> </div> </div> </main> <button id="menu"> <span id="menu-icons"></span> </button> <script src="/assets/js/jquery-2.1.3.min.js"></script> <script src="/assets/js/jquery.pjax.js"></script> <script src="/assets/js/nprogress.js"></script> <script src="/assets/js/main.js"></script> </body> </html>
